var part_state=1,paused=!0;!function(){function e(e,a){e>=82&&(e=81),a>=66&&(a=65);var n=l[a+1][e+1];if(part_state!==d)part_state?l[a+1][e+1][0]||(n[0]=part_state,n[1]=0,n[3]=0,i(e+1,a+1,n)):(n[0]=0,i(e+1,a+1,n));else{if(ctype=n[0],!n[1]&&ctype===S)return c(e+1,a+1,ctype),t();r(e+1,a+1,n),i(e+1,a+1,n)}}function r(e,r,i,t){ctype=i[0],P[ctype]&&i[1]<=0&&(i[2]=ctype,i[0]=d,i[1]=4)}function i(e,r,i){var t;p.fillStyle=k[i[0]],i[0]===I&&i[1]&&(5!==i[2]?p.fillStyle="rgb("+(t=15.95*i[1]|0)+","+t+","+t+")":p.fillStyle="rgb("+(t=100*i[1]|0)+","+3*t/5+","+t/5+")"),p.fillRect(10*(e-1),10*(r-1),10,10)}function t(){for(var e=1;67>e;e++)for(var r=1;83>r;r++)i(r,e,l[e][r])}function a(){for(var e,r,i,a=0;v>a;a++){e=4*a*u;for(var n=0;u>n;n++){if((i=l[a][n])[1])switch(i[1]--,i[0]){case I:i[1]||(i[0]=0)}switch(i[0]){case _:5==i[3]&&(i[0]=g,i[1]=4,i[2]=C),i[3]=0;break;case C:5==i[3]&&(i[0]=g,i[1]=4,i[2]=_),i[3]=0}}}for(r=0;v>r;r++)l[r][0][0]=0,l[r][u-1][0]=0;for(r=0;u>r;r++)l[0][r][0]=0,l[v-1][r][0]=0;for(var a=0;v>a;a++){i=l[a];for(var n=0;u>n;n++)f(n,a,i[n])}t()}function n(e,r){return e>=0&&u>e&&r>=0&&v>r}function f(e,i,t){var a,f,o,s,w,F,b,p,k,B,E,R,j,z,G,H,J=t[0],K=Math.min(2,e),N=Math.min(2,i),O=Math.min(2,u-e-3),Q=Math.min(2,v-i-3);switch(J){case d:if(!t[1])return t[1]=4,void(t[0]=t[2]);if(t[1]>=4)return;for(var T=-N;Q>=T;T++){b=l[f=i+T];for(var U=-K;O>=U;U++)if(!((U>0?U:-U)+(T>0?T:-T)>=4)){switch(p=b[a=e+U],k=t[2],B=p[0],k){case _:(B===y||B===_)&&r(a,f,p);continue;case M:(B===M||B===m||B===A)&&r(a,f,p);continue;case S:B===A&&r(a,f,p);continue}switch(B){case d:switch(p[2]){case _:k===A&&(p[0]=g,p[1]=5,p[2]=C)}continue;case m:if(k===A)continue;break;case C:k===m&&(p[0]=g,p[1]=5,p[2]=_);break;case _:if(k!==y){k===A&&(p[0]=g,p[1]=5,p[2]=C);continue}break;case g:p[2]===_&&p[1]<5&&(k===y?(p[0]=d,p[1]=4):k===A&&(p[1]=5,p[2]=C));continue;case M:(k===m||k===A)&&r(a,f,p);continue;case S:k===m&&c(a,f,B);continue}l[i+f>>1][e+a>>1][0]!==h&&r(a,f,p)}}break;case g:if(t[1]<=0)return void(t[0]=t[2]);if(t[1]>1&&t[1]<5)for(var T=-N;Q>=T;T++){b=l[i+T];for(var U=-K;O>=U;U++)(U>0?U:-U)+(T>0?T:-T)>=4||(p=b[a=e+U],(q[p[0]]||p[0]===d&&q[p[2]]||p[0]===g&&p[2]==_&&t[2]==C)&&(p[2]=t[2],p[0]=g,p[1]=5))}break;case x:for(var T=-N;Q>=T;T++){b=l[f=i+T];for(var U=-K;O>=U;U++)(U>0?U:-U)+(T>0?T:-T)>=4||(p=b[a=e+U],l[i+f>>1][e+a>>1][0]!==h&&p[0]!==M&&r(a=e+U,f,p))}break;case D:w=-4;for(var T=-1;2>T;T++){b=l[f=i+T];for(var U=-1;2>U;U++,w++)if(p=b[a=e+U],p[0]===d&&3===p[1]&&w)for(F=0>w?-w:w,E=-U,R=-T,j=e+E,z=i+R,G=p[2]===S,H=p[2]===m;n(j,z);){if(o=(s=l[z][j])[0]){if(H){if(q[s[0]]&&(s[3]|=1<<F-1),s[0]===M||s[0]===d&&s[2]===M||s[0]===D||s[0]===_||s[0]===g&&s[2]===_){j+=E,z+=R;continue}if(s[0]===I){s[1]=1,s[2]=5,j+=E,z+=R;continue}break}if(s[0]===M||s[0]===d&&s[2]===M||s[0]===D||s[0]===_||s[0]===g&&s[2]===_){j+=E,z+=R;continue}if(s[0]===I){if(s[1]){if(s[2]===F){s[1]=16,j+=E,z+=R;continue}5!==s[2]&&(s[1]=0);break}j+=E,z+=R;continue}if(r(j,z,s),!G||s[0]!==d||!P[s[2]])break}else s[0]=I,s[1]=H?2:16,s[2]=H?5:F;j+=E,z+=R}}break;case L:if(!t[1])for(var V=[-4,4,0,0],W=[0,0,-4,4],X=0;4>X;X++)U=V[X],T=W[X],n(e+U,i+T)&&(p=l[i+T][e+U])[0]==d&&p[1]<4&&r(e,i,t)}}function o(e,r){return r[0]===e||r[0]===d&&r[2]===e}function c(e,r,i){if(l[r][e][1])return 0;var t,a,n,f,c,s,v,w,F,b,p,k,y=[e],h=[r],m=1;do{for(p=k=e=y[--m],r=h[m],F=l[r];(v=p-1)>=0&&F[v][0]===i&&!F[v][1];)p=v;for(;(w=k+1)<u&&F[w][0]===i&&!F[w][1];)k=w;for(b=p;k>=b;b++)F[b][0]=d,F[b][1]=4,F[b][2]=i;if(f=r-1,t=l[f],c=r+1,a=l[c],p===k&&o(i,t[e-1])&&o(i,t[e+1])&&o(i,t[e])&&o(i,(n=l[s=r-2])[e])&&!o(i,n[e-1])&&!o(i,n[e+1]))n[e][0]!==i||n[e][1]||(y[m]=e,h[m++]=s);else for(b=p;k>=b;b++)t[b][0]!==i||t[b][1]||(b===p||b===k||!o(i,a[b])||o(i,a[b+1])||o(i,a[b-1]))&&(y[m]=b,h[m++]=f);if(p===k&&o(i,a[e-1])&&o(i,a[e+1])&&o(i,a[e])&&o(i,(n=l[s=r+2])[e])&&!o(i,n[e-1])&&!o(i,n[e+1]))n[e][0]!==i||n[e][1]||(y[m]=e,h[m++]=s);else for(b=p;k>=b;b++)a[b][0]!==i||a[b][1]||(b===p||b===k||!o(i,t[b])||o(i,t[b+1])||o(i,t[b-1]))&&(y[m]=b,h[m++]=c)}while(m)}function s(){B||(a(),B=5),paused||requestAnimationFrame(s),B--}for(var u=84,v=68,l=[],w=v-1;w>=0;w--){l[w]=[];for(var F=u-1;F>=0;F--)l[w][F]=new Int32Array(5)}var b=document.getElementById("PartLayer"),p=b.getContext("2d"),k=["#000000","#444466","#FFFFCC","#AAAAAA","#805050","#505080","#003000","#20CC20","#108010","#554040","#40403C","#858505","#FFC000","#FFFFFF","#DCAD2C"],y=1,d=2,h=3,m=4,A=5,C=6,_=7,g=8,M=9,S=10,x=11,D=12,I=13,L=14,P=[0,1,0,0,1,1,0,1,0,1,0,0,0,0,1],q=[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],B=0;t(),window.run_frame=a,window.simLoopFn=s,window.clickPixel=e}();