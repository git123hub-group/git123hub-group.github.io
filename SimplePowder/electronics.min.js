var part_state=1,paused=!0,channel_num=0;!function(){function e(e,i){e>=82&&(e=81),i>=66&&(i=65);var c,n=k[i+1][e+1];if(part_state!==m){if(!paused)return;part_state?k[i+1][e+1][0]||(n[0]=part_state,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,part_state===x&&(c=prompt("Enter number value for delay:"),n[2]=c>=1?c:1),part_state===U&&(n[2]=channel_num),r(e+1,i+1,n)):(n[0]=0,r(e+1,i+1,n))}else{if(ctype=n[0],!n[1]&&ctype===P)return o(e+1,i+1,ctype),t();if(!n[1]&&ctype===E)return n[1]=2,r(e+1,i+1,n);a(e+1,i+1,n),r(e+1,i+1,n)}}function a(e,a,r,t){ctype=r[0],B[ctype]&&r[1]<=0&&(r[2]=ctype,r[0]=m,r[1]=4)}function r(e,a,r){var t;switch(y.fillStyle=w[r[0]],r[0]){case T:r[1]>0&&(5!==r[2]?y.fillStyle="rgb("+(t=15.95*r[1]|0)+","+t+","+t+")":y.fillStyle="rgb("+(t=100*r[1]|0)+","+3*t/5+","+t/5+")");break;case x:r[1]>0&&(y.fillStyle="#D078D0");break;case E:2===r[1]?y.fillStyle="#3366FF":1===r[1]&&(y.fillStyle="#FF6633");break;case U:var i=r[2],c=127*Math.sin(.0628318*i+0)+128,n=127*Math.sin(.0628318*i+2)+128,f=127*Math.sin(.0628318*i+4)+128;y.fillStyle="rgb("+[0|c,0|n,0|f].join(",")+")"}y.fillRect(10*(e-1),10*(a-1),10,10)}function t(){for(var e=1;67>e;e++)for(var a=1;83>a;a++)r(a,e,k[e][a])}function i(){var e,a,r;if(b>0)for(a=0;100>a;a++)l[a]>>=1;for(var i=0;v>i;i++){e=4*i*u;for(var c=0;u>c;c++){switch(r=k[i][c],r[0]){case m:(r[2]===j||r[2]===q)&&(r[4]=r[3],r[3]&&r[3]--),r[3]=0;break;case M:5===r[3]&&(r[0]=D,r[1]=4,r[2]=S),r[3]=0;break;case S:5===r[3]&&(r[0]=D,r[1]=4,r[2]=M),r[3]=0;break;case R:r[1]=r[2],r[2]=0;break;case x:r[3]=r[1];break;case E:r[2]=r[1];break;case j:case q:r[4]=r[3],r[3]&&r[3]--}if(r[1])switch(r[1]--,r[0]){case T:r[1]||(r[0]=0)}}}for(a=0;v>a;a++)k[a][0][0]=0,k[a][u-1][0]=0;for(a=0;u>a;a++)k[0][a][0]=0,k[v-1][a][0]=0;for(var i=0;v>i;i++){r=k[i];for(var c=0;u>c;c++)n(c,i,r[c])}t()}function c(e,a){return e>=0&&u>e&&a>=0&&v>a}function n(e,r,t){var i,n,f,s,F,h,p,y,w,H,J,K,O,Q,V,W,X=t[0],Y=G[X],Z=Math.min(Y,e),$=Math.min(Y,r),ee=Math.min(Y,u-e-3),ae=Math.min(Y,v-r-3);switch(X){case m:if(!t[1])return t[1]=4,void(t[0]=t[2]);if(t[1]>=4)return;for(var re=-$;ae>=re;re++){p=k[n=r+re];for(var te=-Z;ee>=te;te++)if(!((te>0?te:-te)+(re>0?re:-re)>=4)&&(y=p[i=e+te],w=t[2],H=y[0],k[r+n>>1][e+i>>1][0]!==C)){switch(w){case M:(H===d||H===M)&&a(i,n,y);continue;case g:(H===g||H===_||H===A)&&a(i,n,y);continue;case P:H===A&&a(i,n,y);continue;case j:(H===_||H===j||H===A&&!t[4])&&a(i,n,y);continue;case q:(H===_||H===q||H===A&&t[4])&&a(i,n,y);continue}switch(H){case m:switch(y[2]){case M:w===A&&(y[0]=D,y[1]=5,y[2]=S);break;case j:case q:w===d&&3===t[1]&&(y[3]=8)}continue;case _:if(w===A)continue;break;case S:w===_&&(y[0]=D,y[1]=5,y[2]=M);break;case M:if(w!==d){w===A&&(y[0]=D,y[1]=5,y[2]=S);continue}break;case D:y[2]===M&&y[1]<5&&(w===d?(y[0]=m,y[1]=4):w===A&&(y[1]=5,y[2]=S));continue;case g:(w===_||w===A)&&a(i,n,y);continue;case P:w===_&&o(i,n,H);continue;case j:w===d&&3===t[1]&&(y[3]=8),(w===A||w===_&&!y[4])&&a(i,n,y);continue;case q:w===d&&3===t[1]&&(y[3]=8),(w===A||w===_&&y[4])&&a(i,n,y);continue}a(i,n,y)}}break;case D:if(t[1]<=0)return void(t[0]=t[2]);if(t[1]>1&&t[1]<5)for(var re=-$;ae>=re;re++){p=k[r+re];for(var te=-Z;ee>=te;te++)(te>0?te:-te)+(re>0?re:-re)>=4||(y=p[i=e+te],(z[y[0]]||y[0]===m&&z[y[2]]||y[0]===D&&y[2]===M&&t[2]===S)&&(y[2]=t[2],y[0]=D,y[1]=5))}break;case I:for(var re=-$;ae>=re;re++){p=k[n=r+re];for(var te=-Z;ee>=te;te++)(te>0?te:-te)+(re>0?re:-re)>=4||(y=p[i=e+te],k[r+n>>1][e+i>>1][0]!==C&&y[0]!==g&&y[0]!==PART_INSUL_PTC&&y[0]!==PART_INSUL_NTC&&a(i=e+te,n,y))}break;case L:F=-4;for(var re=-1;2>re;re++){p=k[n=r+re];for(var te=-1;2>te;te++,F++)if(y=p[i=e+te],y[0]===m&&3===y[1]&&F)for(h=0>F?-F:F,J=-te,K=-re,O=e+J,Q=r+K,V=y[2]===P,W=y[2]===_;c(O,Q);){if(f=(s=k[Q][O])[0]){if(s[0]===R){s[2]=1;break}if(W){if(z[s[0]]&&(s[3]|=1<<h-1),s[0]===g||s[0]===m&&s[2]===g||s[0]===L||s[0]===M||s[0]===D&&s[2]===M){O+=J,Q+=K;continue}if(s[0]===T){s[1]=1,s[2]=5,O+=J,Q+=K;continue}break}if(s[0]===g||s[0]===m&&s[2]===g||s[0]===L||s[0]===M||s[0]===D&&s[2]===M){O+=J,Q+=K;continue}if(s[0]===T){if(s[1]){if(s[2]===h){s[1]=16,O+=J,Q+=K;continue}5!==s[2]&&(s[1]=0);break}O+=J,Q+=K;continue}if(a(O,Q,s),!V||s[0]!==m||!B[s[2]])break}else s[0]=T,s[1]=W?2:16,s[2]=W?5:h;O+=J,Q+=K}}break;case N:if(!t[1])for(var ie=[-4,4,0,0],ce=[0,0,-4,4],ne=0;4>ne;ne++)te=ie[ne],re=ce[ne],c(e+te,r+re)&&(y=k[r+re][e+te])[0]===m&&y[1]<4&&a(e,r,t);break;case R:if(1===t[1])for(var re=-$;ae>=re;re++){p=k[n=r+re];for(var te=-Z;ee>=te;te++)(te>0?te:-te)+(re>0?re:-re)>=4||(y=p[i=e+te],a(i,n,y))}break;case x:for(var re=-$;ae>=re;re++){p=k[n=r+re];for(var te=-Z;ee>=te;te++)if(!((te>0?te:-te)+(re>0?re:-re)>=4)&&k[r+n>>1][e+i>>1][0]!==C)switch(y=p[i=e+te],y[0]){case m:y[1]>0&&y[1]<4&&y[2]===_&&t[1]<=0&&(t[1]=t[2]);break;case x:y[1]<t[1]&&!y[3]&&t[3]&&(y[1]=t[1]);break;case A:1===t[3]&&a(i,n,y)}}break;case E:s=0;for(var re=-$;ae>=re;re++){p=k[n=r+re];for(var te=-Z;ee>=te;te++)switch(y=p[i=e+te],y[0]){case m:if(3===y[1]&&y[2]===_)return void(t[1]=2);break;case A:2===t[2]&&a(i,n,y);break;case E:2===y[2]&&s++}}0!==t[2]||1!==s&&2!==s||(t[1]=2);break;case U:F=t[2];for(var re=-$;ae>=re;re++){p=k[n=r+re];for(var te=-Z;ee>=te;te++)y=p[i=e+te],1&l[F]&&(s=y[0],(s===A||s===_||s===g)&&a(i,n,y)),y[0]===m&&3===y[1]&&y[2]!==A&&(l[F]|=2,b=2)}}}function f(e,a){return a[0]===e||a[0]===m&&a[2]===e}function o(e,a,r){if(k[a][e][1])return 0;var t,i,c,n,o,s,v,l,b,F,h,p,y=[e],w=[a],d=1;do{for(h=p=e=y[--d],a=w[d],b=k[a];(v=h-1)>=0&&b[v][0]===r&&!b[v][1];)h=v;for(;(l=p+1)<u&&b[l][0]===r&&!b[l][1];)p=l;for(F=h;p>=F;F++)b[F][0]=m,b[F][1]=4,b[F][2]=r;if(n=a-1,t=k[n],o=a+1,i=k[o],h===p&&f(r,t[e-1])&&f(r,t[e+1])&&f(r,t[e])&&f(r,(c=k[s=a-2])[e])&&!f(r,c[e-1])&&!f(r,c[e+1]))c[e][0]!==r||c[e][1]||(y[d]=e,w[d++]=s);else for(F=h;p>=F;F++)t[F][0]!==r||t[F][1]||(F===h||F===p||!f(r,i[F])||f(r,i[F+1])||f(r,i[F-1]))&&(y[d]=F,w[d++]=n);if(h===p&&f(r,i[e-1])&&f(r,i[e+1])&&f(r,i[e])&&f(r,(c=k[s=a+2])[e])&&!f(r,c[e-1])&&!f(r,c[e+1]))c[e][0]!==r||c[e][1]||(y[d]=e,w[d++]=s);else for(F=h;p>=F;F++)i[F][0]!==r||i[F][1]||(F===h||F===p||!f(r,t[F])||f(r,t[F+1])||f(r,t[F-1]))&&(y[d]=F,w[d++]=o)}while(d)}function s(){H||(i(),H=5),paused||requestAnimationFrame(s),H--}for(var u=84,v=68,l=[0],b=0,k=[],F=v-1;F>=0;F--){k[F]=[];for(var h=u-1;h>=0;h--)k[F][h]=new Int32Array(6)}for(var F=0;100>F;F++)l[F]=0;var p=document.getElementById("PartLayer"),y=p.getContext("2d"),w=["#000000","#444466","#FFFFCC","#AAAAAA","#805050","#505080","#003000","#20CC20","#108010","#554040","#40403C","#858505","#FFC000","#FFFFFF","#DCAD2C","#FD9D18","#902090","#FFCC00","#40A060","#405050","#505040"],d=1,m=2,C=3,_=4,A=5,S=6,M=7,D=8,g=9,P=10,I=11,L=12,T=13,N=14,R=15,x=16,E=17,U=18,j=19,q=20,B=[0,1,0,0,1,1,0,1,0,1,0,0,0,0,1,0,0,0,0,1,1],z=[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],G=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2],H=0;t(),window.run_frame=i,window.simLoopFn=s,window.clickPixel=e}();