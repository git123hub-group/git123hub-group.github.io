var part_state=1,paused=!0;!function(){function r(r,a){r>=82&&(r=81),a>=66&&(a=65);var i=v[a+1][r+1];if(part_state!==h)part_state?v[a+1][r+1][0]||(i[0]=part_state,i[1]=0,i[3]=0,t(r+1,a+1,i)):(i[0]=0,t(r+1,a+1,i));else{if(ctype=i[0],!i[1]&&ctype===g)return c(r+1,a+1,ctype),n();e(r+1,a+1,i),t(r+1,a+1,i)}}function e(r,e,t){ctype=t[0],I[ctype]&&t[1]<=0&&(t[2]=ctype,t[0]=h,t[1]=4)}function t(r,e,t){d.fillStyle=m[t[0]],d.fillRect(10*(r-1),10*(e-1),10,10)}function n(){for(var r=1;67>r;r++)for(var e=1;83>e;e++)t(e,r,v[r][e])}function a(){for(var r,e,t,a=0;s>a;a++){r=4*a*u;for(var o=0;u>o;o++)(t=v[a][o])[1]&&t[1]--}for(e=0;s>e;e++)v[e][0][0]=0,v[e][u-1][0]=0;for(e=0;u>e;e++)v[0][e][0]=0,v[s-1][e][0]=0;for(var a=0;s>a;a++){t=v[a];for(var o=0;u>o;o++)i(o,a,t[o])}n()}function i(r,t,n){var a,i,o,f,p,l,w=n[0],d=Math.min(2,r),m=Math.min(2,t),I=Math.min(2,u-r-3),P=Math.min(2,s-t-3);switch(w){case h:if(!n[1])return n[1]=4,void(n[0]=n[2]);if(n[1]>=4)return;for(var q=-m;P>=q;q++){o=v[i=t+q];for(var B=-d;I>=B;B++)if(!((B>0?B:-B)+(q>0?q:-q)>=4)){switch(f=o[a=r+B],p=n[2],l=f[0],p){case b:(l===y||l===b)&&e(a,i,f);continue;case M:(l===M||l===k||l===C)&&e(a,i,f);continue;case g:l===C&&e(a,i,f);continue}switch(l){case h:switch(f[2]){case b:p===C&&(f[0]=_,f[1]=4,f[2]=F)}continue;case k:if(p===C)continue;break;case F:p===k&&(f[0]=_,f[1]=4,f[2]=b);break;case b:if(p!==y){p===C&&(f[0]=_,f[1]=4,f[2]=F);continue}break;case _:f[2]===b&&p===y&&(f[0]=h,f[1]=4);continue;case M:(p===k||p===C)&&e(a,i,f);continue;case g:p===k&&c(a,i,l);continue}v[t+i>>1][r+a>>1][0]!==A&&e(a,i,f)}}break;case _:if(n[1]<=0)return void(n[0]=n[2]);if(n[1]<4)for(var q=-m;P>=q;q++){o=v[t+q];for(var B=-d;I>=B;B++)(B>0?B:-B)+(q>0?q:-q)>=4||(f=o[a=r+B],(L[f[0]]||f[0]===h&&L[f[2]])&&(f[2]=n[2],f[0]=_,f[1]=4))}break;case x:for(var q=-m;P>=q;q++){o=v[i=t+q];for(var B=-d;I>=B;B++)(B>0?B:-B)+(q>0?q:-q)>=4||(f=o[a=r+B],v[t+i>>1][r+a>>1][0]!==A&&f[0]!==M&&e(a=r+B,i,f))}}}function o(r,e){return e[0]===r||e[0]===h&&e[2]===r}function c(r,e,t){if(v[e][r][1])return 0;var n,a,i,c,f,s,p,l,w,d,m,y,A=[r],k=[e],C=1;do{for(m=y=r=A[--C],e=k[C],w=v[e];(p=m-1)>=0&&w[p][0]===t&&!w[p][1];)m=p;for(;(l=y+1)<u&&w[l][0]===t&&!w[l][1];)y=l;for(d=m;y>=d;d++)w[d][0]=h,w[d][1]=4,w[d][2]=t;if(c=e-1,n=v[c],f=e+1,a=v[f],m===y&&o(t,n[r-1])&&o(t,n[r+1])&&o(t,n[r])&&o(t,(i=v[s=e-2])[r])&&!o(t,i[r-1])&&!o(t,i[r+1]))i[r][0]!==t||i[r][1]||(A[C]=r,k[C++]=s);else for(d=m;y>=d;d++)n[d][0]!==t||n[d][1]||(d===m||d===y||!o(t,a[d])||o(t,a[d+1])||o(t,a[d-1]))&&(A[C]=d,k[C++]=c);if(m===y&&o(t,a[r-1])&&o(t,a[r+1])&&o(t,a[r])&&o(t,(i=v[s=e+2])[r])&&!o(t,i[r-1])&&!o(t,i[r+1]))i[r][0]!==t||i[r][1]||(A[C]=r,k[C++]=s);else for(d=m;y>=d;d++)a[d][0]!==t||a[d][1]||(d===m||d===y||!o(t,n[d])||o(t,n[d+1])||o(t,n[d-1]))&&(A[C]=d,k[C++]=f)}while(C)}function f(){P||(a(),P=5),paused||requestAnimationFrame(f),P--}for(var u=84,s=68,v=[],p=s-1;p>=0;p--){v[p]=[];for(var l=u-1;l>=0;l--)v[p][l]=new Int32Array(4)}var w=document.getElementById("PartLayer"),d=w.getContext("2d"),m=["#000000","#444466","#FFFFCC","#AAAAAA","#805050","#505080","#003000","#20CC20","#108010","#554040","#40403C","#858505"],y=1,h=2,A=3,k=4,C=5,F=6,b=7,_=8,M=9,g=10,x=11,I=[0,1,0,0,1,1,0,1,0,1,0,0],L=[0,0,0,0,0,0,1,1,0,0,0,0],P=0;n(),window.run_frame=a,window.simLoopFn=f,window.clickPixel=r}();