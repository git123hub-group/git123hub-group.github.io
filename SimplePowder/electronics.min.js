var part_state=1,paused=!0;!function(){function e(e,i){e>=82&&(e=81),i>=66&&(i=65);var a=l[i+1][e+1];if(part_state!==m)part_state?l[i+1][e+1][0]||(a[0]=part_state,a[1]=0,a[3]=0,n(e+1,i+1,a)):(a[0]=0,n(e+1,i+1,a));else{if(ctype=a[0],!a[1]&&ctype===S)return c(e+1,i+1,ctype),t();r(e+1,i+1,a),n(e+1,i+1,a)}}function r(e,r,n,t){ctype=n[0],P[ctype]&&n[1]<=0&&(n[2]=ctype,n[0]=m,n[1]=4)}function n(e,r,n){var t;y.fillStyle=d[n[0]],n[0]===L&&n[1]&&(5!==n[2]?y.fillStyle="rgb("+(t=15.95*n[1]|0)+","+t+","+t+")":y.fillStyle="rgb("+(t=100*n[1]|0)+","+3*t/5+","+t/5+")"),y.fillRect(10*(e-1),10*(r-1),10,10)}function t(){for(var e=1;67>e;e++)for(var r=1;83>r;r++)n(r,e,l[e][r])}function i(){for(var e,r,n,i=0;v>i;i++){e=4*i*s;for(var a=0;s>a;a++)(n=l[i][a])[1]&&(n[1]--,n[0]!==L||n[1]||(n[0]=0))}for(r=0;v>r;r++)l[r][0][0]=0,l[r][s-1][0]=0;for(r=0;s>r;r++)l[0][r][0]=0,l[v-1][r][0]=0;for(var i=0;v>i;i++){n=l[i];for(var a=0;s>a;a++)f(a,i,n[a])}t()}function a(e,r){return e>=0&&s>e&&r>=0&&v>r}function f(e,n,t){var i,f,o,u,F,p,w,y,d,B,E,R,j,z,D,G,H=t[0],J=Math.min(2,e),K=Math.min(2,n),N=Math.min(2,s-e-3),O=Math.min(2,v-n-3);switch(H){case m:if(!t[1])return t[1]=4,void(t[0]=t[2]);if(t[1]>=4)return;for(var Q=-K;O>=Q;Q++){w=l[f=n+Q];for(var T=-J;N>=T;T++)if(!((T>0?T:-T)+(Q>0?Q:-Q)>=4)){switch(y=w[i=e+T],d=t[2],B=y[0],d){case _:(B===b||B===_)&&r(i,f,y);continue;case M:(B===M||B===k||B===A)&&r(i,f,y);continue;case S:B===A&&r(i,f,y);continue}switch(B){case m:switch(y[2]){case _:d===A&&(y[0]=g,y[1]=4,y[2]=C)}continue;case k:if(d===A)continue;break;case C:d===k&&(y[0]=g,y[1]=4,y[2]=_);break;case _:if(d!==b){d===A&&(y[0]=g,y[1]=4,y[2]=C);continue}break;case g:y[2]===_&&y[1]<4&&d===b&&(y[0]=m,y[1]=4);continue;case M:(d===k||d===A)&&r(i,f,y);continue;case S:d===k&&c(i,f,B);continue}l[n+f>>1][e+i>>1][0]!==h&&r(i,f,y)}}break;case g:if(t[1]<=0)return void(t[0]=t[2]);if(t[1]<4)for(var Q=-K;O>=Q;Q++){w=l[n+Q];for(var T=-J;N>=T;T++)(T>0?T:-T)+(Q>0?Q:-Q)>=4||(y=w[i=e+T],(q[y[0]]||y[0]===m&&q[y[2]])&&(y[2]=t[2],y[0]=g,y[1]=4))}break;case x:for(var Q=-K;O>=Q;Q++){w=l[f=n+Q];for(var T=-J;N>=T;T++)(T>0?T:-T)+(Q>0?Q:-Q)>=4||(y=w[i=e+T],l[n+f>>1][e+i>>1][0]!==h&&y[0]!==M&&r(i=e+T,f,y))}case I:F=-4;for(var Q=-1;2>Q;Q++){w=l[f=n+Q];for(var T=-1;2>T;T++,F++)if(y=w[i=e+T],y[0]===m&&3===y[1]&&F)for(p=0>F?-F:F,E=-T,R=-Q,j=e+E,z=n+R,D=y[2]===S,G=y[2]===k;a(j,z);){if(o=(u=l[z][j])[0]){if(G){if(u[0]===M||u[0]===m&&u[2]===M||u[0]===I||u[0]===_||u[0]===g&&u[2]===_){j+=E,z+=R;continue}if(u[0]===L){u[1]=1,u[2]=5,j+=E,z+=R;continue}break}if(u[0]===M||u[0]===m&&u[2]===M||u[0]===I||u[0]===_||u[0]===g&&u[2]===_){j+=E,z+=R;continue}if(u[0]===L){if(u[1]){if(u[2]===p){u[1]=16,j+=E,z+=R;continue}5!==u[2]&&(u[1]=0);break}j+=E,z+=R;continue}if(r(j,z,u),!D||u[0]!==m||!P[u[2]])break}else u[0]=L,u[1]=G?2:16,u[2]=G?5:p;j+=E,z+=R}}}}function o(e,r){return r[0]===e||r[0]===m&&r[2]===e}function c(e,r,n){if(l[r][e][1])return 0;var t,i,a,f,c,u,v,F,p,w,y,d,b=[e],h=[r],k=1;do{for(y=d=e=b[--k],r=h[k],p=l[r];(v=y-1)>=0&&p[v][0]===n&&!p[v][1];)y=v;for(;(F=d+1)<s&&p[F][0]===n&&!p[F][1];)d=F;for(w=y;d>=w;w++)p[w][0]=m,p[w][1]=4,p[w][2]=n;if(f=r-1,t=l[f],c=r+1,i=l[c],y===d&&o(n,t[e-1])&&o(n,t[e+1])&&o(n,t[e])&&o(n,(a=l[u=r-2])[e])&&!o(n,a[e-1])&&!o(n,a[e+1]))a[e][0]!==n||a[e][1]||(b[k]=e,h[k++]=u);else for(w=y;d>=w;w++)t[w][0]!==n||t[w][1]||(w===y||w===d||!o(n,i[w])||o(n,i[w+1])||o(n,i[w-1]))&&(b[k]=w,h[k++]=f);if(y===d&&o(n,i[e-1])&&o(n,i[e+1])&&o(n,i[e])&&o(n,(a=l[u=r+2])[e])&&!o(n,a[e-1])&&!o(n,a[e+1]))a[e][0]!==n||a[e][1]||(b[k]=e,h[k++]=u);else for(w=y;d>=w;w++)i[w][0]!==n||i[w][1]||(w===y||w===d||!o(n,t[w])||o(n,t[w+1])||o(n,t[w-1]))&&(b[k]=w,h[k++]=c)}while(k)}function u(){B||(i(),B=5),paused||requestAnimationFrame(u),B--}for(var s=84,v=68,l=[],F=v-1;F>=0;F--){l[F]=[];for(var p=s-1;p>=0;p--)l[F][p]=new Int32Array(4)}var w=document.getElementById("PartLayer"),y=w.getContext("2d"),d=["#000000","#444466","#FFFFCC","#AAAAAA","#805050","#505080","#003000","#20CC20","#108010","#554040","#40403C","#858505","#FFC000","#FFFFFF"],b=1,m=2,h=3,k=4,A=5,C=6,_=7,g=8,M=9,S=10,x=11,I=12,L=13,P=[0,1,0,0,1,1,0,1,0,1,0,0,0,0,0],q=[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],B=0;t(),window.run_frame=i,window.simLoopFn=u,window.clickPixel=e}();