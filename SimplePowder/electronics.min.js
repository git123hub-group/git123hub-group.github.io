var part_state=1,paused=!0;!function(){function e(e,i){e>=82&&(e=81),i>=66&&(i=65);var n,f=l[i+1][e+1];if(part_state!==d)part_state?l[i+1][e+1][0]||(f[0]=part_state,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=0,part_state===E&&(n=prompt("Enter number value for delay:"),f[2]=n>=1?n:1),a(e+1,i+1,f)):(f[0]=0,a(e+1,i+1,f));else{if(ctype=f[0],!f[1]&&ctype===M)return o(e+1,i+1,ctype),t();r(e+1,i+1,f),a(e+1,i+1,f)}}function r(e,r,a,t){ctype=a[0],q[ctype]&&a[1]<=0&&(a[2]=ctype,a[0]=d,a[1]=4)}function a(e,r,a){var t;p.fillStyle=w[a[0]],a[0]===I&&a[1]?5!==a[2]?p.fillStyle="rgb("+(t=15.95*a[1]|0)+","+t+","+t+")":p.fillStyle="rgb("+(t=100*a[1]|0)+","+3*t/5+","+t/5+")":a[0]===E&&a[1]>0&&(p.fillStyle="#D078D0"),p.fillRect(10*(e-1),10*(r-1),10,10)}function t(){for(var e=1;67>e;e++)for(var r=1;83>r;r++)a(r,e,l[e][r])}function i(){for(var e,r,a,i=0;v>i;i++){e=4*i*u;for(var n=0;u>n;n++){switch(a=l[i][n],a[0]){case _:5===a[3]&&(a[0]=D,a[1]=4,a[2]=C),a[3]=0;break;case C:5===a[3]&&(a[0]=D,a[1]=4,a[2]=_),a[3]=0;break;case P:a[1]=a[2],a[2]=0;break;case E:a[3]=a[1]}if(a[1])switch(a[1]--,a[0]){case I:a[1]||(a[0]=0)}}}for(r=0;v>r;r++)l[r][0][0]=0,l[r][u-1][0]=0;for(r=0;u>r;r++)l[0][r][0]=0,l[v-1][r][0]=0;for(var i=0;v>i;i++){a=l[i];for(var n=0;u>n;n++)f(n,i,a[n])}t()}function n(e,r){return e>=0&&u>e&&r>=0&&v>r}function f(e,a,t){var i,f,c,s,b,k,F,p,w,R,j,z,G,H,J,K,N=t[0],O=Math.min(2,e),Q=Math.min(2,a),T=Math.min(2,u-e-3),U=Math.min(2,v-a-3);switch(N){case d:if(!t[1])return t[1]=4,void(t[0]=t[2]);if(t[1]>=4)return;for(var V=-Q;U>=V;V++){F=l[f=a+V];for(var W=-O;T>=W;W++)if(!((W>0?W:-W)+(V>0?V:-V)>=4)){switch(p=F[i=e+W],w=t[2],R=p[0],w){case _:(R===y||R===_)&&r(i,f,p);continue;case g:(R===g||R===m||R===A)&&r(i,f,p);continue;case M:R===A&&r(i,f,p);continue}switch(R){case d:switch(p[2]){case _:w===A&&(p[0]=D,p[1]=5,p[2]=C)}continue;case m:if(w===A)continue;break;case C:w===m&&(p[0]=D,p[1]=5,p[2]=_);break;case _:if(w!==y){w===A&&(p[0]=D,p[1]=5,p[2]=C);continue}break;case D:p[2]===_&&p[1]<5&&(w===y?(p[0]=d,p[1]=4):w===A&&(p[1]=5,p[2]=C));continue;case g:(w===m||w===A)&&r(i,f,p);continue;case M:w===m&&o(i,f,R);continue}l[a+f>>1][e+i>>1][0]!==h&&r(i,f,p)}}break;case D:if(t[1]<=0)return void(t[0]=t[2]);if(t[1]>1&&t[1]<5)for(var V=-Q;U>=V;V++){F=l[a+V];for(var W=-O;T>=W;W++)(W>0?W:-W)+(V>0?V:-V)>=4||(p=F[i=e+W],(B[p[0]]||p[0]===d&&B[p[2]]||p[0]===D&&p[2]===_&&t[2]===C)&&(p[2]=t[2],p[0]=D,p[1]=5))}break;case S:for(var V=-Q;U>=V;V++){F=l[f=a+V];for(var W=-O;T>=W;W++)(W>0?W:-W)+(V>0?V:-V)>=4||(p=F[i=e+W],l[a+f>>1][e+i>>1][0]!==h&&p[0]!==g&&r(i=e+W,f,p))}break;case x:b=-4;for(var V=-1;2>V;V++){F=l[f=a+V];for(var W=-1;2>W;W++,b++)if(p=F[i=e+W],p[0]===d&&3===p[1]&&b)for(k=0>b?-b:b,j=-W,z=-V,G=e+j,H=a+z,J=p[2]===M,K=p[2]===m;n(G,H);){if(c=(s=l[H][G])[0]){if(s[0]===P){s[2]=1;break}if(K){if(B[s[0]]&&(s[3]|=1<<k-1),s[0]===g||s[0]===d&&s[2]===g||s[0]===x||s[0]===_||s[0]===D&&s[2]===_){G+=j,H+=z;continue}if(s[0]===I){s[1]=1,s[2]=5,G+=j,H+=z;continue}break}if(s[0]===g||s[0]===d&&s[2]===g||s[0]===x||s[0]===_||s[0]===D&&s[2]===_){G+=j,H+=z;continue}if(s[0]===I){if(s[1]){if(s[2]===k){s[1]=16,G+=j,H+=z;continue}5!==s[2]&&(s[1]=0);break}G+=j,H+=z;continue}if(r(G,H,s),!J||s[0]!==d||!q[s[2]])break}else s[0]=I,s[1]=K?2:16,s[2]=K?5:k;G+=j,H+=z}}break;case L:if(!t[1])for(var X=[-4,4,0,0],Y=[0,0,-4,4],Z=0;4>Z;Z++)W=X[Z],V=Y[Z],n(e+W,a+V)&&(p=l[a+V][e+W])[0]===d&&p[1]<4&&r(e,a,t);break;case P:if(1===t[1])for(var V=-Q;U>=V;V++){F=l[f=a+V];for(var W=-O;T>=W;W++)(W>0?W:-W)+(V>0?V:-V)>=4||(p=F[i=e+W],r(i,f,p))}break;case E:for(var V=-Q;U>=V;V++){F=l[f=a+V];for(var W=-O;T>=W;W++)if(!((W>0?W:-W)+(V>0?V:-V)>=4)&&l[a+f>>1][e+i>>1][0]!==h)switch(p=F[i=e+W],p[0]){case d:p[1]>0&&p[1]<4&&p[2]===m&&t[1]<=0&&(t[1]=t[2]);break;case E:p[1]<t[1]&&!p[3]&&t[3]&&(p[1]=t[1]);break;case A:1===t[3]&&r(i,f,p)}}}}function c(e,r){return r[0]===e||r[0]===d&&r[2]===e}function o(e,r,a){if(l[r][e][1])return 0;var t,i,n,f,o,s,v,b,k,F,p,w,y=[e],h=[r],m=1;do{for(p=w=e=y[--m],r=h[m],k=l[r];(v=p-1)>=0&&k[v][0]===a&&!k[v][1];)p=v;for(;(b=w+1)<u&&k[b][0]===a&&!k[b][1];)w=b;for(F=p;w>=F;F++)k[F][0]=d,k[F][1]=4,k[F][2]=a;if(f=r-1,t=l[f],o=r+1,i=l[o],p===w&&c(a,t[e-1])&&c(a,t[e+1])&&c(a,t[e])&&c(a,(n=l[s=r-2])[e])&&!c(a,n[e-1])&&!c(a,n[e+1]))n[e][0]!==a||n[e][1]||(y[m]=e,h[m++]=s);else for(F=p;w>=F;F++)t[F][0]!==a||t[F][1]||(F===p||F===w||!c(a,i[F])||c(a,i[F+1])||c(a,i[F-1]))&&(y[m]=F,h[m++]=f);if(p===w&&c(a,i[e-1])&&c(a,i[e+1])&&c(a,i[e])&&c(a,(n=l[s=r+2])[e])&&!c(a,n[e-1])&&!c(a,n[e+1]))n[e][0]!==a||n[e][1]||(y[m]=e,h[m++]=s);else for(F=p;w>=F;F++)i[F][0]!==a||i[F][1]||(F===p||F===w||!c(a,t[F])||c(a,t[F+1])||c(a,t[F-1]))&&(y[m]=F,h[m++]=o)}while(m)}function s(){R||(i(),R=5),paused||requestAnimationFrame(s),R--}for(var u=84,v=68,l=[],b=v-1;b>=0;b--){l[b]=[];for(var k=u-1;k>=0;k--)l[b][k]=new Int32Array(5)}var F=document.getElementById("PartLayer"),p=F.getContext("2d"),w=["#000000","#444466","#FFFFCC","#AAAAAA","#805050","#505080","#003000","#20CC20","#108010","#554040","#40403C","#858505","#FFC000","#FFFFFF","#DCAD2C","#FD9D18","#902090"],y=1,d=2,h=3,m=4,A=5,C=6,_=7,D=8,g=9,M=10,S=11,x=12,I=13,L=14,P=15,E=16,q=[0,1,0,0,1,1,0,1,0,1,0,0,0,0,1,0],B=[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0],R=0;t(),window.run_frame=i,window.simLoopFn=s,window.clickPixel=e}();