var part_state=1,paused=!0;!function(){function r(r,i){r>=82&&(r=81),i>=66&&(i=65);var a=l[i+1][r+1];if(part_state!==k)part_state?l[i+1][r+1][0]||(a[0]=part_state,a[1]=0,a[3]=0,n(r+1,i+1,a)):(a[0]=0,n(r+1,i+1,a));else{if(ctype=a[0],!a[1]&&ctype===S)return c(r+1,i+1,ctype),t();e(r+1,i+1,a),n(r+1,i+1,a)}}function e(r,e,n,t){ctype=n[0],P[ctype]&&n[1]<=0&&(n[2]=ctype,n[0]=k,n[1]=4)}function n(r,e,n){var t;w.fillStyle=y[n[0]],n[0]===I&&n[1]&&(5!==n[2]?w.fillStyle="rgb("+(t=15.95*n[1]|0)+","+t+","+t+")":w.fillStyle="rgb("+(t=100*n[1]|0)+","+3*t/5+","+t/5+")"),w.fillRect(10*(r-1),10*(e-1),10,10)}function t(){for(var r=1;67>r;r++)for(var e=1;83>e;e++)n(e,r,l[r][e])}function i(){for(var r,e,n,i=0;v>i;i++){r=4*i*s;for(var a=0;s>a;a++)(n=l[i][a])[1]&&(n[1]--,n[0]!==I||n[1]||(n[0]=0))}for(e=0;v>e;e++)l[e][0][0]=0,l[e][s-1][0]=0;for(e=0;s>e;e++)l[0][e][0]=0,l[v-1][e][0]=0;for(var i=0;v>i;i++){n=l[i];for(var a=0;s>a;a++)f(a,i,n[a])}t()}function a(r,e){return r>=0&&s>r&&e>=0&&v>e}function f(r,n,t){var i,f,o,u,F,p,b,w,y,B,E,R,j,z,G,H,J=t[0],K=Math.min(2,r),N=Math.min(2,n),O=Math.min(2,s-r-3),Q=Math.min(2,v-n-3);switch(J){case k:if(!t[1])return t[1]=4,void(t[0]=t[2]);if(t[1]>=4)return;for(var T=-N;Q>=T;T++){b=l[f=n+T];for(var U=-K;O>=U;U++)if(!((U>0?U:-U)+(T>0?T:-T)>=4)){switch(w=b[i=r+U],y=t[2],B=w[0],y){case _:(B===d||B===_)&&e(i,f,w);continue;case M:(B===M||B===h||B===A)&&e(i,f,w);continue;case S:B===A&&e(i,f,w);continue}switch(B){case k:switch(w[2]){case _:y===A&&(w[0]=g,w[1]=4,w[2]=C)}continue;case h:if(y===A)continue;break;case C:y===h&&(w[0]=g,w[1]=4,w[2]=_);break;case _:if(y!==d){y===A&&(w[0]=g,w[1]=4,w[2]=C);continue}break;case g:w[2]===_&&w[1]<4&&y===d&&(w[0]=k,w[1]=4);continue;case M:(y===h||y===A)&&e(i,f,w);continue;case S:y===h&&c(i,f,B);continue}l[n+f>>1][r+i>>1][0]!==m&&e(i,f,w)}}break;case g:if(t[1]<=0)return void(t[0]=t[2]);if(t[1]<4)for(var T=-N;Q>=T;T++){b=l[n+T];for(var U=-K;O>=U;U++)(U>0?U:-U)+(T>0?T:-T)>=4||(w=b[i=r+U],(q[w[0]]||w[0]===k&&q[w[2]]||w[0]===g&&w[2]==_)&&(w[2]=t[2],w[0]=g,w[1]=4))}break;case x:for(var T=-N;Q>=T;T++){b=l[f=n+T];for(var U=-K;O>=U;U++)(U>0?U:-U)+(T>0?T:-T)>=4||(w=b[i=r+U],l[n+f>>1][r+i>>1][0]!==m&&w[0]!==M&&e(i=r+U,f,w))}break;case D:F=-4;for(var T=-1;2>T;T++){b=l[f=n+T];for(var U=-1;2>U;U++,F++)if(w=b[i=r+U],w[0]===k&&3===w[1]&&F)for(p=0>F?-F:F,E=-U,R=-T,j=r+E,z=n+R,G=w[2]===S,H=w[2]===h;a(j,z);){if(o=(u=l[z][j])[0]){if(H){if(u[0]===M||u[0]===k&&u[2]===M||u[0]===D||u[0]===_||u[0]===g&&u[2]===_){j+=E,z+=R;continue}if(u[0]===I){u[1]=1,u[2]=5,j+=E,z+=R;continue}break}if(u[0]===M||u[0]===k&&u[2]===M||u[0]===D||u[0]===_||u[0]===g&&u[2]===_){j+=E,z+=R;continue}if(u[0]===I){if(u[1]){if(u[2]===p){u[1]=16,j+=E,z+=R;continue}5!==u[2]&&(u[1]=0);break}j+=E,z+=R;continue}if(e(j,z,u),!G||u[0]!==k||!P[u[2]])break}else u[0]=I,u[1]=H?2:16,u[2]=H?5:p;j+=E,z+=R}}break;case L:if(!t[1])for(var V=[-4,4,0,0],W=[0,0,-4,4],X=0;4>X;X++)r=V[X],n=W[X],a(r+U,n+T)&&(w=l[n+T][r+U])==k&&w[1]<4&&e(r,n,t)}}function o(r,e){return e[0]===r||e[0]===k&&e[2]===r}function c(r,e,n){if(l[e][r][1])return 0;var t,i,a,f,c,u,v,F,p,b,w,y,d=[r],m=[e],h=1;do{for(w=y=r=d[--h],e=m[h],p=l[e];(v=w-1)>=0&&p[v][0]===n&&!p[v][1];)w=v;for(;(F=y+1)<s&&p[F][0]===n&&!p[F][1];)y=F;for(b=w;y>=b;b++)p[b][0]=k,p[b][1]=4,p[b][2]=n;if(f=e-1,t=l[f],c=e+1,i=l[c],w===y&&o(n,t[r-1])&&o(n,t[r+1])&&o(n,t[r])&&o(n,(a=l[u=e-2])[r])&&!o(n,a[r-1])&&!o(n,a[r+1]))a[r][0]!==n||a[r][1]||(d[h]=r,m[h++]=u);else for(b=w;y>=b;b++)t[b][0]!==n||t[b][1]||(b===w||b===y||!o(n,i[b])||o(n,i[b+1])||o(n,i[b-1]))&&(d[h]=b,m[h++]=f);if(w===y&&o(n,i[r-1])&&o(n,i[r+1])&&o(n,i[r])&&o(n,(a=l[u=e+2])[r])&&!o(n,a[r-1])&&!o(n,a[r+1]))a[r][0]!==n||a[r][1]||(d[h]=r,m[h++]=u);else for(b=w;y>=b;b++)i[b][0]!==n||i[b][1]||(b===w||b===y||!o(n,t[b])||o(n,t[b+1])||o(n,t[b-1]))&&(d[h]=b,m[h++]=c)}while(h)}function u(){B||(i(),B=5),paused||requestAnimationFrame(u),B--}for(var s=84,v=68,l=[],F=v-1;F>=0;F--){l[F]=[];for(var p=s-1;p>=0;p--)l[F][p]=new Int32Array(4)}var b=document.getElementById("PartLayer"),w=b.getContext("2d"),y=["#000000","#444466","#FFFFCC","#AAAAAA","#805050","#505080","#003000","#20CC20","#108010","#554040","#40403C","#858505","#FFC000","#FFFFFF","#DCAD2C"],d=1,k=2,m=3,h=4,A=5,C=6,_=7,g=8,M=9,S=10,x=11,D=12,I=13,L=14,P=[0,1,0,0,1,1,0,1,0,1,0,0,0,0,1],q=[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],B=0;t(),window.run_frame=i,window.simLoopFn=u,window.clickPixel=r}();