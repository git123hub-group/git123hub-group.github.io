function RLELineBreak(b){for(var a=[],e=0,c=0;c<b.length;){for(var d=c,c=c+70;/\d/.test(b[c-1])||"!"===b[c];)--c;a[e++]=b.substring(d,c)}return a.join("\n")}
var exportRLE=function(){for(var b="",a,e,c="",d=0,g=[".","A","B","C"],f=0;128>f;++f){a=array[currOffset+128*f]+2*array[prevOffset+128*f];for(var h=counts=0;128>h;++h)e=a,a=array[currOffset+128*f+h]+2*array[prevOffset+128*f+h],e!==a&&(c+=(1===counts?"":counts)+g[e],counts=0),++counts;a&&(c+=(1===counts?"":counts)+g[a]);c?(d&&(b+=(1===d?"":d)+"$"),b+=c,d=1):++d;c=""}WlAntCode.value="#CXRLE Pos=-64,-64\nx = 128, y = 128, rule = "+crule+":T128,128\n"+RLELineBreak(b+"!")},importRLE=function(b){currOffset=
0;prevOffset=16384;symbols={A:1,B:2,C:3};for(var a=0;32768>a;++a)array[a]=0;b=b.value.split("\n");for(var e=0,c=0,d=0,g=0,a=0;a<b.length;++a)if("x"===b[a].charAt(0)&&(" "===b[a].charAt(1)||"="===b[a].charAt(1)))d=+b[a].match(/\bx = (\d+)/)[1].toLowerCase(),g=+b[a].match(/\by = (\d+)/)[1].toLowerCase(),d=128-d>>1,g=128-g>>1;else if("#"!==b[a].charAt(0))for(var f=b[a];0<f.length;){var h=f.match(/\d*\D/)[0],k=h.slice(-1),l=+h.slice(0,-1);l||(l=1);if("$"===k)c+=l,e=0;else if(/[ABC]/.test(k))for(;l--;)array[prevOffset+
(g+c<<7)+d+e]=symbols[k]&2,array[currOffset+(g+c<<7)+d+e]=symbols[k]&1,e++;else if("."===k)e+=l;else{rerender();return}f=f.slice(h.length)}};