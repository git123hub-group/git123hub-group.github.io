function RLELineBreak(r){for(var e=[],t=0,a=0;a<r.length;){var s=a
for(a+=70;/\d/.test(r[a-1])||"!"===r[a];)--a
e[t++]=r.substring(s,a)}return e.join("\n")}var exportRLE=function(){for(var r,e,t="",a="",s=0,f=[".","A","B","C"],o=0;128>o;++o){r=array[currOffset+128*o]+2*array[prevOffset+128*o],counts=0
for(var n=0;128>n;++n)e=r,r=array[currOffset+128*o+n]+2*array[prevOffset+128*o+n],e!==r&&(a+=(1===counts?"":counts)+f[e],counts=0),++counts
r&&(a+=(1===counts?"":counts)+f[r]),a?(s&&(t+=(1===s?"":s)+"$"),t+=a,s=1):++s,a=""}WlAntCode.value="#CXRLE Pos=-64,-64\nx = 128, y = 128, rule = "+crule+":T128,128\n"+RLELineBreak(t+"!")},importRLE=function(r){currOffset=0,prevOffset=16384,symbols={A:1,B:2,C:3}
for(var e=0;32768>e;++e)array[e]=0
for(var t=r.value.split("\n"),a=0,s=0,f=0,o=0,e=0;e<t.length;++e)if("x"!==t[e].charAt(0)||" "!==t[e].charAt(1)&&"="!==t[e].charAt(1)){if("#"!==t[e].charAt(0))for(var n=t[e];n.length>0;){var c=n.match(/\d*\D/)[0],u=c.slice(-1),l=+c.slice(0,-1)
if(l||(l=1),"$"===u)s+=l,a=0
else if(/[ABC]/.test(u))for(;l--;)array[prevOffset+(o+s<<7)+f+a]=symbols[u]>>1,array[currOffset+(o+s<<7)+f+a]=1&symbols[u],a++
else{if("."!==u)return void rerender()
a+=l}n=n.slice(c.length)}}else{var i=+t[e].match(/\bx = (\d+)/)[1].toLowerCase(),v=+t[e].match(/\by = (\d+)/)[1].toLowerCase()
f=128-i>>1,o=128-v>>1}}
