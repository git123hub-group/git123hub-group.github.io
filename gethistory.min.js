var db,tx,store,random_like_name="innerData%u28faC9Weh",rez,update=!1,historyA=[],historyS="",request=indexedDB.open("data",4);request.onupgradeneeded=function(a){a=request.result;a.objectStoreNames.contains("data")||(a.createObjectStore(random_like_name,{keyPath:"ID"}),update=!0)};
var op=function(){tx=db.transaction(random_like_name,"readwrite");store=tx.objectStore(random_like_name);var a=store.get("History");a.onsuccess=function(){rez=a.result;var c=rez.data;historyA[0]=+new Date;historyS+=(new Date(historyA[0])).toString()+"\n";for(var b=1;60>=b;++b){historyA[b]=c[(rez.ptr+60-b)%60];if(null==historyA[b])break;historyS+=(new Date(historyA[b])).toString()+"\n"}c[rez.ptr]=historyA[0];rez.ptr=(rez.ptr+1)%60;document.getElementById("historyB").innerHTML=historyS;db.transaction(random_like_name,
"readwrite").objectStore(random_like_name).put(rez)}};request.onsuccess=function(){db=request.result;update&&db.transaction(random_like_name,"readwrite").objectStore(random_like_name).put({ID:"History",ptr:0,data:[]});op()};
